---
title: "mybatis-generator API文档生成器简介"
date: 2021-12-17
---

## 一、概述
> mybatis mapper/xml/po 生成工具
> 类似于mybatis官方的[mybatis-generator](https://mybatis.org/generator/)工具

源代码见：[mybatis-generator](https://github.com/jrrwll/mybatis-generator)

## 二、实现原理

1. jdbc获取table ddl
2. 模板引擎生成代码

## 三、接入姿势

### 3.1 gradle 插件接入

```groovy
plugins {
    id 'org.dreamcat.mybatis-generator' version '0.1-SNAPSHOT'
}

mybatisGenerate {
    srcDir = "src/main/java"
    sqlPath = "src/main/resources/ddl.sql"
    // jdbcUrl = "jdbc:mysql://localhost:3306/test"
    // jdbcUser = "root"
    // jdbcPassword = "password"
    // jdbcDriverClassName = "com.mysql.cj.jdbc.Driver"
    // tableNames = ["bill"]
    addComments = false
}
```

```shell
./gradlew mybatisGenerate
```

### 3.2 maven 插件接入

```xml
<plugin>
  <groupId>org.dreamcat</groupId>
  <artifactId>mybatis-generator-maven-plugin</artifactId>
  <version>0.1-SNAPSHOT</version>
  <configuration>
    <srcDir>src/test/java</srcDir>
    <!--<sqlPath>src/test/resources/ddl.sql</sqlPath>-->
    <jdbcUrl>jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false</jdbcUrl>
    <jdbcUser>root</jdbcUser>
    <jdbcPassword>password</jdbcPassword>
    <jdbcDriverClassName>com.mysql.cj.jdbc.Driver</jdbcDriverClassName>
    <delimitKeyword>`</delimitKeyword>
    <tableNames>
      <tableName>bill</tableName>
    </tableNames>
    <entityPackageName>com.example.entity</entityPackageName>
    <mapperPackageName>com.example.mapper.base</mapperPackageName>
    <extendsMapperPackageName>com.example.mapper</extendsMapperPackageName>
  </configuration>
</plugin>
```

```shell
mvn mybatis-generator:mybatisGenerate
```

## 四、输出姿势

### 4.0 测试用例

```sql
create table live_room (
    tenant_id   varchar(32) not null comment 'tenant ID',
    seq_id      bigint      not null comment 'seq id',
    record_date date        not null comment 'record date',
    room_id     varchar(30) not null comment '',
    created_at  datetime default current_timestamp,
    extra       text comment '',
    primary key (tenant_id, seq_id, record_date)
) comment 'a live room record';

create table way_bill (
    way_bill_id bigint   not null comment 'waybill id',
    customer_id bigint   not null comment 'customer ID',
    shop_id     varchar(50)       default null, -- shop id
    created_at  datetime not null default current_timestamp,
    primary key (`way_bill_id`)
) comment = 'a waybill record';
```

### 4.1 生成的代码一览

```
├── entity
│   ├── condition
│   │   ├── LiveRoomCondition.java
│   │   └── WayBillCondition.java
│   ├── LiveRoom.java
│   └── WayBill.java
├── mapper
│   ├── base
│   │   ├── LiveRoomBaseMapper.java
│   │   ├── LiveRoomBaseMapper.xml
│   │   ├── WayBillBaseMapper.java
│   │   └── WayBillBaseMapper.xml
│   ├── LiveRoomMapper.java
│   ├── LiveRoomMapper.xml
│   ├── WayBillMapper.java
│   └── WayBillMapper.xml
```

```java
package com.example.mapper.base;

import com.example.entity.WayBill;
import com.example.entity.condition.WayBillCondition;
import org.apache.ibatis.annotations.Param;

import java.util.*;

/**
 * This class was generated by Mybatis-Generator
 *
 * @author username
 * @version yyyy-MM-dd
 */
public interface WayBillBaseMapper {

    int insert(WayBill entity);

    int insertSelective(WayBill entity);

    int batchInsert(List<WayBill> entity);

    int deleteByPrimaryKey(@Param("wayBillId") Long wayBillId);

    int delete(WayBillCondition condition);

    WayBill selectByPrimaryKey(@Param("wayBillId") Long wayBillId);

    List<WayBill> select(WayBillCondition condition);

    long count(WayBillCondition condition);

    int updateByPrimaryKey(WayBill entity);

    int updateByPrimaryKeySelective(WayBill entity);

    int update(@Param("entity") WayBill entity, @Param("condition") WayBillCondition condition);

    int updateSelective(@Param("entity") WayBill entity, @Param("condition") WayBillCondition condition);
}
```

```java
package com.example.mapper;

import com.example.mapper.base.WayBillBaseMapper;
import org.apache.ibatis.annotations.Mapper;

/**
 * This class was generated by Mybatis-Generator
 *
 * @author username
 * @version yyyy-MM-dd
 */
@Mapper
public interface WayBillMapper extends WayBillBaseMapper {
}
```

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.WayBillMapper">

  <resultMap id="BaseResultMap" type="com.example.entity.WayBill" extends="com.example.mapper.base.WayBillBaseMapper.BaseResultMap"/>

  <sql id="base_column_list">
    <include refid="com.example.mapper.base.WayBillBaseMapper.base_column_list"/>
  </sql>

</mapper>
```
